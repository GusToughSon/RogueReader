<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>RogueReader.au3</title>
<meta name="Generator" content="SciTE - www.Scintilla.org" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">
.S0 {
	color: #000000;
	font-size: 10pt;
}
.S1 {
	font-style: italic;
	color: #008000;
	font-size: 10pt;
}
.S3 {
	color: #0000FF;
	font-size: 10pt;
}
.S4 {
	color: #000090;
	font-size: 10pt;
}
.S5 {
	color: #0000FF;
	font-size: 10pt;
}
.S6 {
	color: #808000;
	font-size: 10pt;
}
.S7 {
	color: #FF0000;
	font-size: 10pt;
}
.S8 {
	color: #FF8000;
	font-size: 10pt;
}
.S9 {
	color: #5A5A5A;
	font-size: 10pt;
}
.S10 {
	color: #808080;
	font-size: 10pt;
}
.S11 {
	color: #808000;
	font-size: 10pt;
}
.S12 {
	color: #DC143C;
	font-size: 10pt;
}
.S15 {
	color: #0080FF;
	font-size: 10pt;
}
span {
	font-family: 'Courier New';
	color: #000000;
	font-size: 10pt;
}
</style>
</head>
<body bgcolor="#F0F4F9">
<span><span class="S12">#Region</span><span class="S1"> ;**** Directives created by AutoIt3Wrapper_GUI ****</span><br />
<span class="S12">#AutoIt3Wrapper_Icon=Include\RogueReader.ico</span><br />
<span class="S12">#AutoIt3Wrapper_Compression=4</span><br />
<span class="S12">#AutoIt3Wrapper_UseX64=y</span><br />
<span class="S12">#AutoIt3Wrapper_Res_Description=Trainer for ProjectRogue</span><br />
<span class="S12">#AutoIt3Wrapper_Res_Fileversion=5.0.0.37</span><br />
<span class="S12">#AutoIt3Wrapper_Res_Fileversion_AutoIncrement=y</span><br />
<span class="S12">#AutoIt3Wrapper_Res_ProductName=Rogue Reader</span><br />
<span class="S12">#AutoIt3Wrapper_Res_ProductVersion=4</span><br />
<span class="S12">#AutoIt3Wrapper_Res_CompanyName=Training Trainers.LLC</span><br />
<span class="S12">#AutoIt3Wrapper_Res_LegalCopyright=Use only for authorized security testing.</span><br />
<span class="S12">#AutoIt3Wrapper_Res_LegalTradeMarks=TrainingTrainersLLC</span><br />
<span class="S12">#AutoIt3Wrapper_Res_Language=1033</span><br />
<span class="S12">#AutoIt3Wrapper_Run_AU3Check=n</span><br />
<span class="S12">#AutoIt3Wrapper_Run_Tidy=y</span><br />
<span class="S12">#AutoIt3Wrapper_Tidy_Stop_OnError=n</span><br />
<span class="S12">#EndRegion</span><span class="S1"> ;**** Directives created by AutoIt3Wrapper_GUI ****</span><br />
<span class="S12">#Region</span><span class="S1"> ;**** Directives created by AutoIt3Wrapper_GUI ****</span><br />
<span class="S12">#AutoIt3Wrapper_Icon=Include\RogueReader.ico</span><br />
<span class="S12">#AutoIt3Wrapper_Compression=4</span><br />
<span class="S12">#AutoIt3Wrapper_UseX64=y</span><br />
<span class="S12">#AutoIt3Wrapper_Res_Description=Trainer for ProjectRogue</span><br />
<span class="S12">#AutoIt3Wrapper_Res_Fileversion=5.0.0.37</span><br />
<span class="S12">#AutoIt3Wrapper_Res_Fileversion_AutoIncrement=y</span><br />
<span class="S12">#AutoIt3Wrapper_Res_ProductName=Rogue Reader</span><br />
<span class="S12">#AutoIt3Wrapper_Res_ProductVersion=4</span><br />
<span class="S12">#AutoIt3Wrapper_Res_CompanyName=Training Trainers.LLC</span><br />
<span class="S12">#AutoIt3Wrapper_Res_LegalCopyright=Use only for authorized security testing.</span><br />
<span class="S12">#AutoIt3Wrapper_Res_LegalTradeMarks=TrainingTrainersLLC</span><br />
<span class="S12">#AutoIt3Wrapper_Res_Language=1033</span><br />
<span class="S12">#AutoIt3Wrapper_Run_AU3Check=n</span><br />
<span class="S12">#AutoIt3Wrapper_Tidy_Stop_OnError=n</span><br />
<span class="S12">#EndRegion</span><span class="S1"> ;**** Directives created by AutoIt3Wrapper_GUI ****</span><br />
<br />
<span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;GUIConstantsEx.au3&gt;</span><br />
<span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;File.au3&gt;</span><br />
<span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;WindowsConstants.au3&gt;</span><br />
<span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;WinAPI.au3&gt;</span><br />
<span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;Process.au3&gt;</span><br />
<span class="S11">#include</span><span class="S0"> </span><span class="S7">&lt;Array.au3&gt;</span><span class="S0"> </span><span class="S1">; For _ArraySearch</span><br />
<br />
<span class="S1">; ---------------------------------------------------------------------------------</span><br />
<span class="S1">; 1) Define fallback constants for Lock/Unlock if your AutoIt version doesn't have them</span><br />
<span class="S1">; ---------------------------------------------------------------------------------</span><br />
<span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S4">IsDeclared</span><span class="S8">(</span><span class="S7">"SW_LOCKDRAW"</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$SW_LOCKDRAW</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">133</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">; numeric values introduced in v3.3.17</span><br />
<span class="S5">EndIf</span><br />
<br />
<span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S4">IsDeclared</span><span class="S8">(</span><span class="S7">"SW_UNLOCKDRAW"</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$SW_UNLOCKDRAW</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">134</span><br />
<span class="S5">EndIf</span><br />
<br />
<span class="S4">Opt</span><span class="S8">(</span><span class="S7">"MouseCoordMode"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">)</span><br />
<br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$version</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">FileGetVersion</span><span class="S8">(</span><span class="S6">@ScriptFullPath</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$locationFile</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S6">@ScriptDir</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"\Locations.ini"</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$currentLocations</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$maxLocations</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">20000</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S5">Const</span><span class="S0"> </span><span class="S9">$sButtonConfigFile</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S6">@ScriptDir</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"\NewButtonConfig.ini"</span><br />
<br />
<span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Script Version: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$version</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<br />
<span class="S1">; --- Load Config Settings ---</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$aTempBlocked</span><span class="S8">[</span><span class="S3">0</span><span class="S8">][</span><span class="S3">2</span><span class="S8">]</span><br />
<br />
<span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S4">FileExists</span><span class="S8">(</span><span class="S9">$sButtonConfigFile</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> CreateButtonDefaultConfig</span><span class="S8">()</span><br />
<span class="S0">LoadButtonConfig</span><span class="S8">()</span><br />
<br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$iCurrentIndex</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> LoadLocations</span><span class="S8">()</span><span class="S0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">; This may show error if the file is missing</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$Debug</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootIdleTimer</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootIdleWaiting</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootQueued</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootCount</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootReady</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootTimer</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$PausedWalkerForLoot</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LastPlayerX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LastPlayerY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$HadTarget</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LastTargetHeld</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LastTargetTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootingCheckbox</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootCheckX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootCheckY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><br />
<br />
<span class="S1">; Define the game process and memory offsets</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$ProcessName</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"Project Rogue Client.exe"</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$WindowName</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"Project Rogue"</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$TypeOffset</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0xBE7974</span><span class="S0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">; ; 0=Player, 1=Monster, etc</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$AttackModeOffset</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0xB5BC00</span><span class="S0"> &nbsp;</span><span class="S1">;</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$PosYOffset</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0xBF9E08</span><span class="S0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">;</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$PosXOffset</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0xBF9E10</span><span class="S0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">;</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$HPOffset</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x7C400</span><span class="S0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">;</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$MaxHPOffset</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x7C404</span><span class="S0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">;</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$ChattOpenOffset</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0xB678D8</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$SicknessOffset</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x7C5E4</span><span class="S0"> &nbsp;&nbsp;&nbsp;</span><span class="S1">;</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$BackPack</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x731A8</span><span class="S0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">;</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$BackPackMax</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0x731AC</span><span class="S0"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="S1">;</span><br />
<br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$MovmentSlider</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">200</span><span class="S0"> </span><span class="S1">;walk after removed from gui turned to solid state,</span><br />
<br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$currentTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LastHealTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$Running</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$HealerStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$CureStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$TargetStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$iPrevValue</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">95</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$MPrevValue</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">" "</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$TypeAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$AttackModeAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$HPAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$MaxHPAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ChattOpenAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$SicknessAddress</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$Type</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Chat</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Sickness</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$AttackMode</span><br />
<br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$sicknessArray</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S3">65</span><span class="S8">,</span><span class="S0"> </span><span class="S3">66</span><span class="S8">,</span><span class="S0"> </span><span class="S3">67</span><span class="S8">,</span><span class="S0"> </span><span class="S3">68</span><span class="S8">,</span><span class="S0"> </span><span class="S3">69</span><span class="S8">,</span><span class="S0"> </span><span class="S3">72</span><span class="S8">,</span><span class="S0"> </span><span class="S3">73</span><span class="S8">,</span><span class="S0"> </span><span class="S3">81</span><span class="S8">,</span><span class="S0"> </span><span class="S3">97</span><span class="S8">,</span><span class="S0"> </span><span class="S3">98</span><span class="S8">,</span><span class="S0"> </span><span class="S3">99</span><span class="S8">,</span><span class="S0"> </span><span class="S3">257</span><span class="S8">,</span><span class="S0"> </span><span class="S3">258</span><span class="S8">,</span><span class="S0"> </span><span class="S3">513</span><span class="S8">,</span><span class="S0"> </span><span class="S3">514</span><span class="S8">,</span><span class="S0"> </span><span class="S3">515</span><span class="S8">,</span><span class="S0"> </span><span class="S3">577</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S3">8193</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8194</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8195</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8257</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8258</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8705</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8706</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8707</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8708</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8709</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8712</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8713</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S3">8721</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8737</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8769</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8770</span><span class="S8">,</span><span class="S0"> </span><span class="S3">16385</span><span class="S8">,</span><span class="S0"> </span><span class="S3">16386</span><span class="S8">,</span><span class="S0"> </span><span class="S3">16449</span><span class="S8">,</span><span class="S0"> </span><span class="S3">16450</span><span class="S8">,</span><span class="S0"> </span><span class="S3">16451</span><span class="S8">,</span><span class="S0"> </span><span class="S3">16452</span><span class="S8">,</span><span class="S0"> </span><span class="S3">16897</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S3">16898</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24577</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24578</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24579</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24581</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24582</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24583</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24585</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24609</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24641</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S3">24642</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24643</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24645</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24646</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24647</span><span class="S8">,</span><span class="S0"> </span><span class="S3">24649</span><span class="S8">,</span><span class="S0"> </span><span class="S3">25089</span><span class="S8">,</span><span class="S0"> </span><span class="S3">25090</span><span class="S8">,</span><span class="S0"> </span><span class="S3">25091</span><span class="S8">,</span><span class="S0"> </span><span class="S3">25093</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S3">25094</span><span class="S8">,</span><span class="S0"> </span><span class="S3">25095</span><span class="S8">,</span><span class="S0"> </span><span class="S3">25097</span><span class="S8">,</span><span class="S0"> </span><span class="S3">25121</span><span class="S8">,</span><span class="S0"> </span><span class="S3">33283</span><span class="S8">,</span><span class="S0"> </span><span class="S3">33284</span><span class="S8">,</span><span class="S0"> </span><span class="S3">33285</span><span class="S8">,</span><span class="S0"> </span><span class="S3">33286</span><span class="S8">,</span><span class="S0"> </span><span class="S3">33287</span><span class="S8">,</span><span class="S0"> </span><span class="S3">33288</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S3">33289</span><span class="S8">,</span><span class="S0"> </span><span class="S3">33291</span><span class="S8">,</span><span class="S0"> </span><span class="S3">33293</span><span class="S8">,</span><span class="S0"> </span><span class="S3">33294</span><span class="S8">,</span><span class="S0"> </span><span class="S3">33295</span><span class="S8">,</span><span class="S0"> </span><span class="S3">33793</span><span class="S8">,</span><span class="S0"> </span><span class="S3">41985</span><span class="S8">,</span><span class="S0"> </span><span class="S3">41986</span><span class="S8">,</span><span class="S0"> </span><span class="S3">41987</span><span class="S8">,</span><span class="S0"> </span><span class="S3">41988</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S3">41989</span><span class="S8">,</span><span class="S0"> </span><span class="S3">41990</span><span class="S8">,</span><span class="S0"> </span><span class="S3">41991</span><span class="S8">,</span><span class="S0"> </span><span class="S3">41993</span><span class="S8">,</span><span class="S0"> </span><span class="S3">41995</span><span class="S8">]</span><br />
<br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$TargetDelay</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$HealDelay</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1700</span><br />
<br />
<span class="S1">; -------------------</span><br />
<span class="S1">; Create the GUI</span><br />
<span class="S1">; -------------------</span><br />
<span class="S1">;...;</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$Gui</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICreate</span><span class="S8">(</span><span class="S9">$version</span><span class="S8">,</span><span class="S0"> </span><span class="S3">248</span><span class="S8">,</span><span class="S0"> </span><span class="S3">360</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$TypeLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"Target: N/A"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">105</span><span class="S8">,</span><span class="S0"> </span><span class="S3">21</span><span class="S8">,</span><span class="S0"> </span><span class="S3">115</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$AttackModeLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"Attack: N/A"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">105</span><span class="S8">,</span><span class="S0"> </span><span class="S3">37</span><span class="S8">,</span><span class="S0"> </span><span class="S3">115</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$PosXLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"X: N/A"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">11</span><span class="S8">,</span><span class="S0"> </span><span class="S3">23</span><span class="S8">,</span><span class="S0"> </span><span class="S3">75</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$PosYLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"Y: N/A"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">11</span><span class="S8">,</span><span class="S0"> </span><span class="S3">39</span><span class="S8">,</span><span class="S0"> </span><span class="S3">75</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$HPLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"HP: N/A /"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S3">187</span><span class="S8">,</span><span class="S0"> </span><span class="S3">45</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$ChatLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"Chat: N/A"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">105</span><span class="S8">,</span><span class="S0"> </span><span class="S3">69</span><span class="S8">,</span><span class="S0"> </span><span class="S3">115</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$SicknessLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"Sickness: N/A"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">105</span><span class="S8">,</span><span class="S0"> </span><span class="S3">53</span><span class="S8">,</span><span class="S0"> </span><span class="S3">115</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$MaxHPLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"N/A"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">55</span><span class="S8">,</span><span class="S0"> </span><span class="S3">187</span><span class="S8">,</span><span class="S0"> </span><span class="S3">30</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$TargetLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"Target: Off"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S3">124</span><span class="S8">,</span><span class="S0"> </span><span class="S3">75</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$HealerLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"Healer: Off"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S3">92</span><span class="S8">,</span><span class="S0"> </span><span class="S3">75</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$WalkerLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"Walker: Off"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S3">140</span><span class="S8">,</span><span class="S0"> </span><span class="S3">75</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$BackPackLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"Weight: N/A"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S3">203</span><span class="S8">,</span><span class="S0"> </span><span class="S3">75</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$CureLabel</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"Cure: Off"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S3">108</span><span class="S8">,</span><span class="S0"> </span><span class="S3">75</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$KillButton</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateButton</span><span class="S8">(</span><span class="S7">"Kill Rogue"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S3">315</span><span class="S8">,</span><span class="S0"> </span><span class="S3">110</span><span class="S8">,</span><span class="S0"> </span><span class="S3">30</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$ExitButton</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateButton</span><span class="S8">(</span><span class="S7">"Exit"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">120</span><span class="S8">,</span><span class="S0"> </span><span class="S3">315</span><span class="S8">,</span><span class="S0"> </span><span class="S3">110</span><span class="S8">,</span><span class="S0"> </span><span class="S3">30</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$ReverseLoopCheckbox</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateCheckbox</span><span class="S8">(</span><span class="S7">"Reversed Walker"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">105</span><span class="S8">,</span><span class="S0"> </span><span class="S3">205</span><span class="S8">,</span><span class="S0"> </span><span class="S3">115</span><span class="S8">,</span><span class="S0"> </span><span class="S3">20</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootingCheckbox</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateCheckbox</span><span class="S8">(</span><span class="S7">"Autoloot"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">107</span><span class="S8">,</span><span class="S0"> </span><span class="S3">185</span><span class="S8">,</span><span class="S0"> </span><span class="S3">115</span><span class="S8">,</span><span class="S0"> </span><span class="S3">20</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$Checkbox</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateCheckbox</span><span class="S8">(</span><span class="S7">"Old Style Pothack"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">105</span><span class="S8">,</span><span class="S0"> </span><span class="S3">225</span><span class="S8">,</span><span class="S0"> </span><span class="S3">115</span><span class="S8">,</span><span class="S0"> </span><span class="S3">20</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0xBEBEBE</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$Helpers</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"HELPERS"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8</span><span class="S8">,</span><span class="S0"> </span><span class="S3">75</span><span class="S8">,</span><span class="S0"> </span><span class="S3">80</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0x808080</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$Character</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"CHARACTER"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8</span><span class="S8">,</span><span class="S0"> </span><span class="S3">170</span><span class="S8">,</span><span class="S0"> </span><span class="S3">80</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0x808080</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$Position</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"POSITION"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8</span><span class="S8">,</span><span class="S0"> </span><span class="S3">5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">80</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0x808080</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$Information</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"INFORMATION"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">103</span><span class="S8">,</span><span class="S0"> </span><span class="S3">4</span><span class="S8">,</span><span class="S0"> </span><span class="S3">120</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0x808080</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$Options</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"OPTIONS"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">103</span><span class="S8">,</span><span class="S0"> </span><span class="S3">169</span><span class="S8">,</span><span class="S0"> </span><span class="S3">120</span><span class="S8">,</span><span class="S0"> </span><span class="S3">11</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0x808080</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$HealToggle</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateButton</span><span class="S8">(</span><span class="S7">"HEAL"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">95</span><span class="S8">,</span><span class="S0"> </span><span class="S3">92</span><span class="S8">,</span><span class="S0"> </span><span class="S3">60</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$CureToggle</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateButton</span><span class="S8">(</span><span class="S7">"CURE"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">95</span><span class="S8">,</span><span class="S0"> </span><span class="S3">108</span><span class="S8">,</span><span class="S0"> </span><span class="S3">60</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$TargetToggle</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateButton</span><span class="S8">(</span><span class="S7">"TARGET"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">95</span><span class="S8">,</span><span class="S0"> </span><span class="S3">124</span><span class="S8">,</span><span class="S0"> </span><span class="S3">60</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$WalkerToggle</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateButton</span><span class="S8">(</span><span class="S7">"WALKER"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">95</span><span class="S8">,</span><span class="S0"> </span><span class="S3">140</span><span class="S8">,</span><span class="S0"> </span><span class="S3">60</span><span class="S8">,</span><span class="S0"> </span><span class="S3">15</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$ToggleAll</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateButton</span><span class="S8">(</span><span class="S7">"ToggleAll"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">155</span><span class="S8">,</span><span class="S0"> </span><span class="S3">94</span><span class="S8">,</span><span class="S0"> </span><span class="S3">71</span><span class="S8">,</span><span class="S0"> </span><span class="S3">60</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetFont</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">8.5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">400</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_FONTNORMAL</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"$GUI_FONTNORMAL"</span><span class="S8">)</span><br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$HP2Label</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateLabel</span><span class="S8">(</span><span class="S7">"RealHp: N/A"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">11</span><span class="S8">,</span><span class="S0"> </span><span class="S3">224</span><span class="S8">,</span><span class="S0"> </span><span class="S3">76</span><span class="S8">,</span><span class="S0"> </span><span class="S3">21</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetBkColor</span><span class="S8">(-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0x9D9597</span><span class="S8">)</span><br />
<br />
<span class="S5">Global</span><span class="S0"> </span><span class="S9">$healSlider</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlCreateSlider</span><span class="S8">(</span><span class="S3">10</span><span class="S8">,</span><span class="S0"> </span><span class="S3">270</span><span class="S8">,</span><span class="S0"> </span><span class="S3">226</span><span class="S8">,</span><span class="S0"> </span><span class="S3">36</span><span class="S8">)</span><br />
<span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$healSlider</span><span class="S8">,</span><span class="S0"> </span><span class="S3">85</span><span class="S8">)</span><br />
<br />
<br />
<br />
<br />
<span class="S4">GUISetState</span><span class="S8">(</span><span class="S6">@SW_SHOW</span><span class="S8">)</span><br />
<br />
<span class="S1">; --------------------------------------------------------------------------</span><br />
<span class="S1">; &nbsp;&nbsp;: &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;STREAMLINED MAIN LOOP</span><br />
<span class="S1">; --------------------------------------------------------------------------</span><br />
<span class="S5">While</span><span class="S0"> </span><span class="S9">$Running</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$msg</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUIGetMsg</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; ---- Handle GUI messages first ----</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Switch</span><span class="S0"> </span><span class="S9">$msg</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S9">$ExitButton</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$GUI_EVENT_CLOSE</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S15">_WinAPI_CloseHandle</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUIDelete</span><span class="S8">(</span><span class="S9">$Gui</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Exit</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S9">$KillButton</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$pidCheck</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">ProcessExists</span><span class="S8">(</span><span class="S9">$ProcessName</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$pidCheck</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S4">ProcessClose</span><span class="S8">(</span><span class="S9">$pidCheck</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S9">$HealToggle</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ToggleHealer</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S9">$CureToggle</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ToggleCure</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S9">$TargetToggle</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ToggleTarget</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S9">$WalkerToggle</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ToggleWalker</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S9">$ToggleAll</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ToggleAllHelpers</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndSwitch</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; ---- Now background work ----</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$ProcessID</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">ProcessExists</span><span class="S8">(</span><span class="S9">$ProcessName</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$ProcessID</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S15">_WinAPI_CloseHandle</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$hProcess</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">Sleep</span><span class="S8">(</span><span class="S3">10</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">ContinueLoop</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; ConnectToBaseAddress</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">Sleep</span><span class="S8">(</span><span class="S3">10</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">ContinueLoop</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ChangeAddressToBase</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; GUIReadMemory</span><span class="S8">()</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$Chat</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$CureStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$Chat</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> CureMe</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$HealerStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$Chat</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> TimeToHeal</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$TargetStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> AttackModeReader</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$LootingCheckbox</span><span class="S8">)</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$GUI_CHECKED</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> HandleLootQueue</span><span class="S8">()</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$LootQueued</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$Chat</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$result</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> MoveToLocationsStep</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$iCurrentIndex</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">Sleep</span><span class="S8">(</span><span class="S3">50</span><span class="S8">)</span><span class="S0"> </span><span class="S1">; lighter sleep, much more responsive</span><br />
<span class="S5">WEnd</span><br />
<br />
<span class="S4">GUIDelete</span><span class="S8">(</span><span class="S9">$Gui</span><span class="S8">)</span><br />
<span class="S15">_WinAPI_CloseHandle</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">)</span><br />
<span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Debug] Trainer closed by script end"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S5">Exit</span><br />
<br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S1">; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOAD CONFIG</span><br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S5">Func</span><span class="S0"> LoadButtonConfig</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$sButtonConfigFile</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S6">@ScriptDir</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"\NewButtonConfig.ini"</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Remove old/unused entries</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">IniDelete</span><span class="S8">(</span><span class="S9">$sButtonConfigFile</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Hotkeys"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"TogglePauseHotkey"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">IniDelete</span><span class="S8">(</span><span class="S9">$sButtonConfigFile</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Hotkeys"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"PlayLocationsHotkey"</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Define the hotkeys and default values</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$aKeys</span><span class="S8">[</span><span class="S3">7</span><span class="S8">][</span><span class="S3">2</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"HealHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"{"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S4">Chr</span><span class="S8">(</span><span class="S3">96</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"}"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"CureHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{-}</span><span class="S7">"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"TargetHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{=}</span><span class="S7">"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"ExitHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{#}</span><span class="S7">"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"SaveLocationHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{F7}</span><span class="S7">"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"EraseLocationsHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{F8}</span><span class="S7">"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"MoveToLocationsHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{!}</span><span class="S7">"</span><span class="S8">]</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">]</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$bMissingKeys</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">For</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aKeys</span><span class="S8">)</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$sKey</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">IniRead</span><span class="S8">(</span><span class="S9">$sButtonConfigFile</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Hotkeys"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aKeys</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">0</span><span class="S8">],</span><span class="S0"> </span><span class="S7">""</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$sKey</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">""</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Warning] Missing key: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$aKeys</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">". Will create default config."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$bMissingKeys</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">ExitLoop</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Next</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; If any key was missing, recreate the default configuration</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$bMissingKeys</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; CreateButtonDefaultConfig</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Re-read keys</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">For</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aKeys</span><span class="S8">)</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$sKey</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">IniRead</span><span class="S8">(</span><span class="S9">$sButtonConfigFile</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Hotkeys"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aKeys</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">0</span><span class="S8">],</span><span class="S0"> </span><span class="S9">$aKeys</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">1</span><span class="S8">])</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Switch</span><span class="S0"> </span><span class="S9">$aKeys</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">0</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S7">"HealHotkey"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">HotKeySet</span><span class="S8">(</span><span class="S9">$sKey</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Hotkeyshit"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S7">"CureHotkey"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">HotKeySet</span><span class="S8">(</span><span class="S9">$sKey</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"CureKeyShit"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S7">"TargetHotkey"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">HotKeySet</span><span class="S8">(</span><span class="S9">$sKey</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"TargetKeyShit"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S7">"ExitHotkey"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">HotKeySet</span><span class="S8">(</span><span class="S9">$sKey</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"KilledWithFire"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S7">"SaveLocationHotkey"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">HotKeySet</span><span class="S8">(</span><span class="S9">$sKey</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"SaveLocation"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S7">"EraseLocationsHotkey"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">HotKeySet</span><span class="S8">(</span><span class="S9">$sKey</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"EraseLocations"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S7">"MoveToLocationsHotkey"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">HotKeySet</span><span class="S8">(</span><span class="S9">$sKey</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"MoveToLocations"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndSwitch</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Info] Hotkey for "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$aKeys</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">" set to "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$sKey</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Next</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;LoadButtonConfig</span><br />
<br />
<span class="S5">Func</span><span class="S0"> Min</span><span class="S8">(</span><span class="S9">$a</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$b</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$a</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S9">$b</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$a</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$b</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;Min</span><br />
<br />
<span class="S5">Func</span><span class="S0"> QueueLootPattern</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootQueue</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Screen click coordinates</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$rawX</span><span class="S8">[</span><span class="S3">8</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S3">320</span><span class="S8">,</span><span class="S0"> </span><span class="S3">350</span><span class="S8">,</span><span class="S0"> </span><span class="S3">385</span><span class="S8">,</span><span class="S0"> </span><span class="S3">325</span><span class="S8">,</span><span class="S0"> </span><span class="S3">385</span><span class="S8">,</span><span class="S0"> </span><span class="S3">325</span><span class="S8">,</span><span class="S0"> </span><span class="S3">350</span><span class="S8">,</span><span class="S0"> </span><span class="S3">385</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$rawY</span><span class="S8">[</span><span class="S3">8</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S3">325</span><span class="S8">,</span><span class="S0"> </span><span class="S3">320</span><span class="S8">,</span><span class="S0"> </span><span class="S3">325</span><span class="S8">,</span><span class="S0"> </span><span class="S3">355</span><span class="S8">,</span><span class="S0"> </span><span class="S3">355</span><span class="S8">,</span><span class="S0"> </span><span class="S3">385</span><span class="S8">,</span><span class="S0"> </span><span class="S3">390</span><span class="S8">,</span><span class="S0"> </span><span class="S3">385</span><span class="S8">]</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Shuffle logic</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$used</span><span class="S8">[</span><span class="S3">8</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">For</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> </span><span class="S3">7</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Do</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$rand</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">Random</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S3">7</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Until</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$used</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootQueue</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$rawX</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootQueue</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">1</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$rawY</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$used</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Next</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Loot] New loot pattern queued."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;QueueLootPattern</span><br />
<br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S1">; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HANDLE LOOT QUEUE</span><br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S5">Func</span><span class="S0"> HandleLootQueue</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$WindowName</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootQueued</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LootCount</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LootReady</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PausedWalkerForLoot</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$LastPlayerX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LastPlayerY</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootIdleTimer</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LootIdleWaiting</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; No loot queued? Skip</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$LootQueued</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$LootCount</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Not finished waiting for idle? Skip</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$LootIdleWaiting</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; 750ms idle time check</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S4">TimerDiff</span><span class="S8">(</span><span class="S9">$LootIdleTimer</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S3">750</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Check movement</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$PlayerX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$PlayerY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$PlayerX</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$LastPlayerX</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$PlayerY</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$LastPlayerY</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Loot] Player moved before looting. Cancelling."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootQueued</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootCount</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootReady</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootIdleWaiting</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Pause walker</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$PausedWalkerForLoot</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Loot] Walker paused for looting."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Looting starts</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Calculate clicks per tile based on kill count</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$clicksPerTile</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> CalculateLootClicks</span><span class="S8">(</span><span class="S9">$LootCount</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Loot] Looting now with "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$clicksPerTile</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">" clicks per tile."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$memX</span><span class="S8">[</span><span class="S3">8</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S3">192</span><span class="S8">,</span><span class="S0"> </span><span class="S3">175</span><span class="S8">,</span><span class="S0"> </span><span class="S3">160</span><span class="S8">,</span><span class="S0"> </span><span class="S3">162</span><span class="S8">,</span><span class="S0"> </span><span class="S3">162</span><span class="S8">,</span><span class="S0"> </span><span class="S3">175</span><span class="S8">,</span><span class="S0"> </span><span class="S3">192</span><span class="S8">,</span><span class="S0"> </span><span class="S3">192</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$memY</span><span class="S8">[</span><span class="S3">8</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S3">161</span><span class="S8">,</span><span class="S0"> </span><span class="S3">159</span><span class="S8">,</span><span class="S0"> </span><span class="S3">161</span><span class="S8">,</span><span class="S0"> </span><span class="S3">176</span><span class="S8">,</span><span class="S0"> </span><span class="S3">191</span><span class="S8">,</span><span class="S0"> </span><span class="S3">194</span><span class="S8">,</span><span class="S0"> </span><span class="S3">191</span><span class="S8">,</span><span class="S0"> </span><span class="S3">176</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$clickX</span><span class="S8">[</span><span class="S3">8</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S3">385</span><span class="S8">,</span><span class="S0"> </span><span class="S3">350</span><span class="S8">,</span><span class="S0"> </span><span class="S3">320</span><span class="S8">,</span><span class="S0"> </span><span class="S3">325</span><span class="S8">,</span><span class="S0"> </span><span class="S3">325</span><span class="S8">,</span><span class="S0"> </span><span class="S3">350</span><span class="S8">,</span><span class="S0"> </span><span class="S3">385</span><span class="S8">,</span><span class="S0"> </span><span class="S3">385</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$clickY</span><span class="S8">[</span><span class="S3">8</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S3">325</span><span class="S8">,</span><span class="S0"> </span><span class="S3">320</span><span class="S8">,</span><span class="S0"> </span><span class="S3">325</span><span class="S8">,</span><span class="S0"> </span><span class="S3">355</span><span class="S8">,</span><span class="S0"> </span><span class="S3">385</span><span class="S8">,</span><span class="S0"> </span><span class="S3">390</span><span class="S8">,</span><span class="S0"> </span><span class="S3">385</span><span class="S8">,</span><span class="S0"> </span><span class="S3">355</span><span class="S8">]</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$used</span><span class="S8">[</span><span class="S3">8</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">]</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">For</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> </span><span class="S3">7</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Do</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$rand</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">Random</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S3">7</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Until</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$used</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$used</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">True</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; _WriteMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S3">0xA669F0</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$memX</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">])</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; _WriteMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S3">0xB5BC0C</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$memY</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">])</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">For</span><span class="S0"> </span><span class="S9">$j</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> </span><span class="S9">$clicksPerTile</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlClick</span><span class="S8">(</span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"right"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$clickX</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">],</span><span class="S0"> </span><span class="S9">$clickY</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">])</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">Sleep</span><span class="S8">(</span><span class="S3">1</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Next</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Loot] Clicked ("</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$clickX</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">]</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">","</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$clickY</span><span class="S8">[</span><span class="S9">$rand</span><span class="S8">]</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">") x"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$clicksPerTile</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Next</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Reset state</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$LootQueued</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$LootCount</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$LootReady</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$LootIdleWaiting</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Resume walker</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$PausedWalkerForLoot</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$PausedWalkerForLoot</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Loot] Walker resumed after looting."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;HandleLootQueue</span><br />
<br />
<span class="S5">Func</span><span class="S0"> CalculateLootClicks</span><span class="S8">(</span><span class="S9">$kills</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$kills</span><span class="S0"> </span><span class="S8">&lt;=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$kills</span><span class="S0"> </span><span class="S8">&lt;=</span><span class="S0"> </span><span class="S3">3</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">4</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$kills</span><span class="S0"> </span><span class="S8">&lt;=</span><span class="S0"> </span><span class="S3">6</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">6</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$kills</span><span class="S0"> </span><span class="S8">&lt;=</span><span class="S0"> </span><span class="S3">9</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">8</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$kills</span><span class="S0"> </span><span class="S8">&lt;=</span><span class="S0"> </span><span class="S3">12</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">10</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$kills</span><span class="S0"> </span><span class="S8">&lt;=</span><span class="S0"> </span><span class="S3">15</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">12</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$kills</span><span class="S0"> </span><span class="S8">&lt;=</span><span class="S0"> </span><span class="S3">18</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">14</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">16</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;CalculateLootClicks</span><br />
<br />
<span class="S5">Func</span><span class="S0"> ClickTile</span><span class="S8">(</span><span class="S9">$x</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$y</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">MouseClick</span><span class="S8">(</span><span class="S7">"right"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$x</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$y</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">)</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;ClickTile</span><br />
<br />
<br />
<span class="S5">Func</span><span class="S0"> CreateButtonDefaultConfig</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$sButtonConfigFile</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S6">@ScriptDir</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"\NewButtonConfig.ini"</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$aKeys</span><span class="S8">[</span><span class="S3">7</span><span class="S8">][</span><span class="S3">2</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">[</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"HealHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"{"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S4">Chr</span><span class="S8">(</span><span class="S3">96</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"}"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"CureHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{-}</span><span class="S7">"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"TargetHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{=}</span><span class="S7">"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"ExitHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{#}</span><span class="S7">"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"SaveLocationHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{F7}</span><span class="S7">"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"EraseLocationsHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{F8}</span><span class="S7">"</span><span class="S8">],</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">[</span><span class="S7">"MoveToLocationsHotkey"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{!}</span><span class="S7">"</span><span class="S8">]</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">For</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aKeys</span><span class="S8">)</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">IniWrite</span><span class="S8">(</span><span class="S9">$sButtonConfigFile</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Hotkeys"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aKeys</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">0</span><span class="S8">],</span><span class="S0"> </span><span class="S9">$aKeys</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">1</span><span class="S8">])</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Next</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Info] Default ButtonConfig.ini created with hotkeys."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;CreateButtonDefaultConfig</span><br />
<br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S1">; &nbsp;&nbsp;Function to Open Process &amp; Retrieve Base Address</span><br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S5">Func</span><span class="S0"> ConnectToBaseAddress</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$hProcess</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$ProcessID</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$BaseAddress</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$hProcess</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S15">_WinAPI_OpenProcess</span><span class="S8">(</span><span class="S3">0x1F0FFF</span><span class="S8">,</span><span class="S0"> </span><span class="S5">False</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ProcessID</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Error] Failed to open process! Try running as administrator."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _GetModuleBase_EnumModules</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Error] Failed to obtain a valid base address!"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;ConnectToBaseAddress</span><br />
<br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S1">; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;READ AND UPDATE GUI FROM MEMORY</span><br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S5">Func</span><span class="S0"> GUIReadMemory</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$hProcess</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$Type</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$TypeAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$WalkerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$AttackMode</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$AttackModeAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$HPAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$MaxHPAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$ChattOpenAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Chat</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$SicknessAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Sickness</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$BackPack</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$BackPackMax</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$BackPackAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$BackPackMaxAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$HealerStatus</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$CureStatus</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$TargetStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$HealerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$CureLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$TargetLabel</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootQueued</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LootCount</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LootReady</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LootIdleWaiting</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Read Type</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$TypeAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$TypeLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Type: Player"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$TypeLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Type: Monster"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">2</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$TypeLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Type: NPC"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">65535</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$TypeLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Type: No Target"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$TypeLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Type: Unknown ("</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">")"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Walker On/Off</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$WalkerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Walker: Off"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$WalkerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Walker: On"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$WalkerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Error: Broken"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Attack Mode</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$AttackMode</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$AttackModeAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$AttackMode</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$AttackModeLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Attack Mode: Safe"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$AttackMode</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$AttackModeLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Attack Mode: Attack"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$AttackModeLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Attack Mode: No Target"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Position</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$PosX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$PosY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$PosXLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Pos X: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$PosX</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$PosYLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Pos Y: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$PosY</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; HP</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$HP</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$HPAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$HPLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"HP: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$HP</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$HP2Label</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"RealHp: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$HP</span><span class="S0"> </span><span class="S8">/</span><span class="S0"> </span><span class="S3">65536</span><span class="S8">))</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; MaxHP</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$MaxHP</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$MaxHPAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$MaxHPLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"MaxHP: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$MaxHP</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Chat</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$ChatVal</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ChattOpenAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$Chat</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$ChatVal</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$ChatLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Chat: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$ChatVal</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Sickness</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$SickVal</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$SicknessAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$Sickness</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$SickVal</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$SicknessDescription</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> GetSicknessDescription</span><span class="S8">(</span><span class="S9">$SickVal</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$SicknessLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Sickness: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$SicknessDescription</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Backpack Weight</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$bpWeight</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$BackPackAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$bpMax</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$BackPackMaxAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$BackPackLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Weight "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$bpWeight</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">" / "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$bpMax</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; --- Death Detection via sudden teleport ---</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S5">Static</span><span class="S0"> </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$dx</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">Abs</span><span class="S8">(</span><span class="S9">$PosX</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S9">$lastX</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$dy</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">Abs</span><span class="S8">(</span><span class="S9">$PosY</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S9">$lastY</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$dx</span><span class="S0"> </span><span class="S8">&gt;</span><span class="S0"> </span><span class="S3">25</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$dy</span><span class="S0"> </span><span class="S8">&gt;</span><span class="S0"> </span><span class="S3">25</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[DeathDetect] Large movement detected: ΔX="</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$dx</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">", ΔY="</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$dy</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">". Assuming death."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; Disable all helpers</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$WalkerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Walker: Off"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[DeathDetect] Walker disabled."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; If $TargetStatus = 1 Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $TargetStatus = 0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GUICtrlSetData($TargetLabel, "Target: Off")</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ConsoleWrite("[DeathDetect] Targeting disabled." &amp; @CRLF)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; If $HealerStatus = 1 Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $HealerStatus = 0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GUICtrlSetData($HealerLabel, "Healer: Off")</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ConsoleWrite("[DeathDetect] Healer disabled." &amp; @CRLF)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; If $CureStatus = 1 Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; $CureStatus = 0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; GUICtrlSetData($CureLabel, "Cure: Off")</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ConsoleWrite("[DeathDetect] Cure disabled." &amp; @CRLF)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">;&nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp; EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; Clear any loot</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootQueued</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootCount</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootReady</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootIdleWaiting</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$PosX</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$PosY</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;GUIReadMemory</span><br />
<br />
<span class="S5">Func</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProc</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$pAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$hProc</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$pAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">0</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$tBuffer</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"dword"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$aRead</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"kernel32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"bool"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"ReadProcessMemory"</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"handle"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hProc</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$pAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetPtr</span><span class="S8">(</span><span class="S9">$tBuffer</span><span class="S8">),</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"dword"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetSize</span><span class="S8">(</span><span class="S9">$tBuffer</span><span class="S8">),</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$aRead</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$tBuffer</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;_ReadMemory</span><br />
<br />
<span class="S5">Func</span><span class="S0"> _GetModuleBase_EnumModules</span><span class="S8">(</span><span class="S9">$hProc</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$hPsapi</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllOpen</span><span class="S8">(</span><span class="S7">"psapi.dll"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$hPsapi</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">0</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$tModules</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"ptr[1024]"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$tBytesNeeded</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"dword"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$aCall</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"psapi.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"bool"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"EnumProcessModules"</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"handle"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hProc</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetPtr</span><span class="S8">(</span><span class="S9">$tModules</span><span class="S8">),</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"dword"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetSize</span><span class="S8">(</span><span class="S9">$tModules</span><span class="S8">),</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetPtr</span><span class="S8">(</span><span class="S9">$tBytesNeeded</span><span class="S8">))</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$aCall</span><span class="S8">[</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">DllClose</span><span class="S8">(</span><span class="S9">$hPsapi</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; The first module in the list is usually the main EXE</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$pBaseAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructGetData</span><span class="S8">(</span><span class="S9">$tModules</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllClose</span><span class="S8">(</span><span class="S9">$hPsapi</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$pBaseAddress</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;_GetModuleBase_EnumModules</span><br />
<br />
<span class="S5">Func</span><span class="S0"> ChangeAddressToBase</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$BaseAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$TypeOffset</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$AttackModeOffset</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXOffset</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYOffset</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$HPOffset</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$MaxHPOffset</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ChattOpenOffset</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$SicknessOffset</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$BackPack</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$BackPackMax</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$TypeAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$AttackModeAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$HPAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$MaxHPAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ChattOpenAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$SicknessAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$BackPackAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$BackPackMaxAddress</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$TypeAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$TypeOffset</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$AttackModeAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$AttackModeOffset</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$PosXAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$PosXOffset</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$PosYAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$PosYOffset</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$HPAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$HPOffset</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$MaxHPAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$MaxHPOffset</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$ChattOpenAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$ChattOpenOffset</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$SicknessAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$SicknessOffset</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$BackPackAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$BackPack</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$BackPackMaxAddress</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$BaseAddress</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$BackPackMax</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;ChangeAddressToBase</span><br />
<br />
<br />
<span class="S1">; --------------------------------------------------------------------------</span><br />
<span class="S1">; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Hotkey Toggle Functions</span><br />
<span class="S1">; --------------------------------------------------------------------------</span><br />
<span class="S12">#Region</span><span class="S1"> ;toggles;</span><br />
<span class="S5">Func</span><span class="S0"> Hotkeyshit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$HealerStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$HealerStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$HealerStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$HealerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Healer: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$HealerStatus</span><span class="S0"> </span><span class="S8">?</span><span class="S0"> </span><span class="S7">"On"</span><span class="S0"> </span><span class="S8">:</span><span class="S0"> </span><span class="S7">"Off"</span><span class="S8">))</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;Hotkeyshit</span><br />
<br />
<span class="S5">Func</span><span class="S0"> CureKeyShit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$CureStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$CureStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$CureStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$CureLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Cure: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$CureStatus</span><span class="S0"> </span><span class="S8">?</span><span class="S0"> </span><span class="S7">"On"</span><span class="S0"> </span><span class="S8">:</span><span class="S0"> </span><span class="S7">"Off"</span><span class="S8">))</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;CureKeyShit</span><br />
<br />
<span class="S5">Func</span><span class="S0"> TargetKeyShit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$TargetStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$TargetStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$TargetStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$TargetLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Target: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$TargetStatus</span><span class="S0"> </span><span class="S8">?</span><span class="S0"> </span><span class="S7">"On"</span><span class="S0"> </span><span class="S8">:</span><span class="S0"> </span><span class="S7">"Off"</span><span class="S8">))</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;TargetKeyShit</span><br />
<br />
<span class="S5">Func</span><span class="S0"> KilledWithFire</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$Debug</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$Debug</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Killed with fire"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Exit</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;KilledWithFire</span><br />
<br />
<br />
<span class="S5">Func</span><span class="S0"> ToggleHealer</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$HealerStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$HealerStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$HealerStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$HealerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Healer: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$HealerStatus</span><span class="S0"> </span><span class="S8">?</span><span class="S0"> </span><span class="S7">"On"</span><span class="S0"> </span><span class="S8">:</span><span class="S0"> </span><span class="S7">"Off"</span><span class="S8">))</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[GUI] Healer toggled to: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$HealerStatus</span><span class="S0"> </span><span class="S8">?</span><span class="S0"> </span><span class="S7">"On"</span><span class="S0"> </span><span class="S8">:</span><span class="S0"> </span><span class="S7">"Off"</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;ToggleHealer</span><br />
<br />
<span class="S5">Func</span><span class="S0"> ToggleCure</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$CureStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$CureStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$CureStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$CureLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Cure: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$CureStatus</span><span class="S0"> </span><span class="S8">?</span><span class="S0"> </span><span class="S7">"On"</span><span class="S0"> </span><span class="S8">:</span><span class="S0"> </span><span class="S7">"Off"</span><span class="S8">))</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[GUI] Cure toggled to: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$CureStatus</span><span class="S0"> </span><span class="S8">?</span><span class="S0"> </span><span class="S7">"On"</span><span class="S0"> </span><span class="S8">:</span><span class="S0"> </span><span class="S7">"Off"</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;ToggleCure</span><br />
<br />
<span class="S5">Func</span><span class="S0"> ToggleTarget</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$TargetStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$TargetStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$TargetStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$TargetLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Target: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$TargetStatus</span><span class="S0"> </span><span class="S8">?</span><span class="S0"> </span><span class="S7">"On"</span><span class="S0"> </span><span class="S8">:</span><span class="S0"> </span><span class="S7">"Off"</span><span class="S8">))</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[GUI] Target toggled to: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$TargetStatus</span><span class="S0"> </span><span class="S8">?</span><span class="S0"> </span><span class="S7">"On"</span><span class="S0"> </span><span class="S8">:</span><span class="S0"> </span><span class="S7">"Off"</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;ToggleTarget</span><br />
<br />
<span class="S5">Func</span><span class="S0"> ToggleWalker</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$iCurrentIndex</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; MoveToLocations</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; MoveToLocationsStep</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$iCurrentIndex</span><span class="S8">)</span><span class="S0"> </span><span class="S1">; &lt;&lt;&lt; NEW LINE!</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$WalkerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Walker: On"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[GUI] Walker toggled to: On"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$WalkerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Walker: Off"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[GUI] Walker toggled to: Off"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;ToggleWalker</span><br />
<br />
<span class="S5">Func</span><span class="S0"> ToggleAllHelpers</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$HealerStatus</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$CureStatus</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$TargetStatus</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$TotalOn</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$HealerStatus</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S9">$TotalOn</span><span class="S0"> </span><span class="S8">+=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$CureStatus</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S9">$TotalOn</span><span class="S0"> </span><span class="S8">+=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$TargetStatus</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S9">$TotalOn</span><span class="S0"> </span><span class="S8">+=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S9">$TotalOn</span><span class="S0"> </span><span class="S8">+=</span><span class="S0"> </span><span class="S3">1</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$TotalOn</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; Turn all OFF</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$HealerStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$CureStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$TargetStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$HealerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Healer: Off"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$CureLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Cure: Off"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$TargetLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Target: Off"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$WalkerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Walker: Off"</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[GUI] ToggleAll: All turned OFF"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; Turn all ON</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$HealerStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$CureStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$TargetStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$HealerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Healer: On"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$CureLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Cure: On"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$TargetLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Target: On"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">GUICtrlSetData</span><span class="S8">(</span><span class="S9">$WalkerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Walker: On"</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[GUI] ToggleAll: All turned ON"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;ToggleAllHelpers</span><br />
<span class="S12">#EndRegion</span><span class="S1"> ;toggles;</span><br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S1">; Optional: Return a more human label for some “Sick” codes</span><br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S5">Func</span><span class="S0"> GetSicknessDescription</span><span class="S8">(</span><span class="S9">$Sick</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$SicknessDescription</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"Unknown"</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Switch</span><span class="S0"> </span><span class="S9">$Sick</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$SicknessDescription</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"Poison1 ("</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$Sick</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">")"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S3">2</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$SicknessDescription</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"Disease1 ("</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$Sick</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">")"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; ...</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Case</span><span class="S0"> </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$SicknessDescription</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$Sick</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndSwitch</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$SicknessDescription</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;GetSicknessDescription</span><br />
<br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S1">; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOCATION LOADING</span><br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S5">Func</span><span class="S0"> LoadLocations</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S4">FileExists</span><span class="S8">(</span><span class="S9">$locationFile</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Error] Location file not found: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$locationFile</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S4">SetError</span><span class="S8">(</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$aLines</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">FileReadToArray</span><span class="S8">(</span><span class="S9">$locationFile</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Error] Failed to read file: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$locationFile</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S4">SetError</span><span class="S8">(</span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$iLocationCount</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Dim</span><span class="S0"> </span><span class="S9">$aTempLocations</span><span class="S8">[</span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aLines</span><span class="S8">)][</span><span class="S3">2</span><span class="S8">]</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">For</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aLines</span><span class="S8">)</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$aMatches</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">StringRegExp</span><span class="S8">(</span><span class="S9">$aLines</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">],</span><span class="S0"> </span><span class="S7">"X:(\d+);Y:(\d+)"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">3</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aMatches</span><span class="S8">)</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">2</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$aTempLocations</span><span class="S8">[</span><span class="S9">$iLocationCount</span><span class="S8">][</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">Int</span><span class="S8">(</span><span class="S9">$aMatches</span><span class="S8">[</span><span class="S3">0</span><span class="S8">])</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$aTempLocations</span><span class="S8">[</span><span class="S9">$iLocationCount</span><span class="S8">][</span><span class="S3">1</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">Int</span><span class="S8">(</span><span class="S9">$aMatches</span><span class="S8">[</span><span class="S3">1</span><span class="S8">])</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$iLocationCount</span><span class="S0"> </span><span class="S8">+=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Warning] Failed to parse line "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">": "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$aLines</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">]</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Next</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$iLocationCount</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Warning] No valid locations found in "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$locationFile</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S4">SetError</span><span class="S8">(</span><span class="S3">3</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ReDim</span><span class="S0"> </span><span class="S9">$aTempLocations</span><span class="S8">[</span><span class="S9">$iLocationCount</span><span class="S8">][</span><span class="S3">2</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Success] Loaded "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$iLocationCount</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">" locations."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$aTempLocations</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;LoadLocations</span><br />
<br />
<span class="S5">Func</span><span class="S0"> SaveLocation</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$currentLocations</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$maxLocations</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S0"> &nbsp;</span><span class="S1">; &lt;&lt;&lt; Need this to reload</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$x</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$y</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Attempting to read X: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$x</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">" Y: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$y</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Error] Failed to read memory. Error code: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$x</span><span class="S0"> </span><span class="S8">==</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$y</span><span class="S0"> </span><span class="S8">==</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Warning] Read zero for both coordinates. Possibly a bad read."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S4">FileExists</span><span class="S8">(</span><span class="S9">$locationFile</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$file</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">FileOpen</span><span class="S8">(</span><span class="S9">$locationFile</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$FO_CREATEPATH</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$FO_OVERWRITE</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$file</span><span class="S0"> </span><span class="S8">==</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Error] Failed to create file: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$locationFile</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">FileClose</span><span class="S8">(</span><span class="S9">$file</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Info] File created: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$locationFile</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$data</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">" : Location"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$currentLocations</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"=X:"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$x</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">";Y:"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$y</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$currentLocations</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S9">$maxLocations</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S15">_FileWriteLog</span><span class="S8">(</span><span class="S9">$locationFile</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$data</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Error] Failed to write to file: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$locationFile</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Info] Data written: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$data</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$currentLocations</span><span class="S0"> </span><span class="S8">+=</span><span class="S0"> </span><span class="S3">1</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; ===== FIX: Reload locations after save =====</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$aLocations</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> LoadLocations</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S6">@error</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Error] Failed to reload locations after save!"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Info] Locations reloaded successfully after save."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Info] Maximum locations reached. Stop pressing the button!"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;SaveLocation</span><br />
<br />
<span class="S5">Func</span><span class="S0"> EraseLocations</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">FileDelete</span><span class="S8">(</span><span class="S9">$locationFile</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$currentLocations</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Success - All locations erased."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;EraseLocations</span><br />
<br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S1">; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;LOCATION WALKING</span><br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S5">Func</span><span class="S0"> MoveToLocations</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$iCurrentIndex</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aLocations</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$iCurrentIndex</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> FindClosestLocationIndex</span><span class="S8">(</span><span class="S9">$currentX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$iCurrentIndex</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Error] Could not find a closest location index (no valid data?)."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"move on"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"move off"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">MsgBox</span><span class="S8">(</span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Error"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"You shouldn't have gotten this error"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">5</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;MoveToLocations</span><br />
<br />
<span class="S5">Func</span><span class="S0"> MoveToLocationsStep</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">,</span><span class="S0"> </span><span class="S5">ByRef</span><span class="S0"> </span><span class="S9">$iCurrentIndex</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$TypeAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$lastX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$lastY</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$aTempBlocked</span><span class="S8">[</span><span class="S3">0</span><span class="S8">][</span><span class="S3">2</span><span class="S8">],</span><span class="S0"> </span><span class="S9">$ReverseLoopCheckbox</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S1">; &lt;--- ADD THIS LINE to have access to the live status</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Static</span><span class="S0"> </span><span class="S9">$lastMoveTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Static</span><span class="S0"> </span><span class="S9">$stuckCount</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Static</span><span class="S0"> </span><span class="S9">$lastTargetX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$lastTargetY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; EARLY EXIT: if toggled off during movement</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><span class="S0"> </span><span class="S4">SetError</span><span class="S8">(</span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Walker turned off mid-step"</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S4">IsArray</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><span class="S0"> </span><span class="S4">SetError</span><span class="S8">(</span><span class="S3">2</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Invalid input"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$iCurrentIndex</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$iCurrentIndex</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><span class="S0"> </span><span class="S4">SetError</span><span class="S8">(</span><span class="S3">3</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Index out of range"</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$reverse</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">(</span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$ReverseLoopCheckbox</span><span class="S8">)</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$GUI_CHECKED</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$targetX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S8">[</span><span class="S9">$iCurrentIndex</span><span class="S8">][</span><span class="S3">0</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$targetY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S8">[</span><span class="S9">$iCurrentIndex</span><span class="S8">][</span><span class="S3">1</span><span class="S8">]</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$lastTargetX</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$targetX</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$lastTargetY</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$targetY</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$stuckCount</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastTargetX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$targetX</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastTargetY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$targetY</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> IsBlockedCoord</span><span class="S8">(</span><span class="S9">$targetX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$targetY</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Skipping known blocked coordinate ("</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$targetX</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">", "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$targetY</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">")"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$iCurrentIndex</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> NextIndex</span><span class="S8">(</span><span class="S9">$iCurrentIndex</span><span class="S8">,</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">),</span><span class="S0"> </span><span class="S9">$reverse</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$TypeAddress</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; EARLY EXIT: again before move attempt</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><span class="S0"> </span><span class="S4">SetError</span><span class="S8">(</span><span class="S3">4</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Walker turned off mid-step"</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S3">65535</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><span class="S0"> </span><span class="S5">False</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S4">TimerDiff</span><span class="S8">(</span><span class="S9">$lastMoveTime</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&gt;</span><span class="S0"> </span><span class="S3">1000</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Detected stuck, trying bypass."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$beforeX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentX</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$beforeY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentY</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$bypassSuccess</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> TryBypass</span><span class="S8">()</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$bypassSuccess</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$beforeX</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$beforeY</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Bypass moved us away. Marking previous target blocked and skipping."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MarkCoordAsBlocked</span><span class="S8">(</span><span class="S9">$lastTargetX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$lastTargetY</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$iCurrentIndex</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> NextIndex</span><span class="S8">(</span><span class="S9">$iCurrentIndex</span><span class="S8">,</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">),</span><span class="S0"> </span><span class="S9">$reverse</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastMoveTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentX</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentY</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$stuckCount</span><span class="S0"> </span><span class="S8">+=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$stuckCount</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S3">3</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; MarkCoordAsBlocked</span><span class="S8">(</span><span class="S9">$targetX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$targetY</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Skipping stubborn target at ("</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$targetX</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">", "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$targetY</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">")"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$iCurrentIndex</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> NextIndex</span><span class="S8">(</span><span class="S9">$iCurrentIndex</span><span class="S8">,</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">),</span><span class="S0"> </span><span class="S9">$reverse</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$stuckCount</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastMoveTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentX</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentY</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$targetX</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$targetY</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Arrived at target index: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$iCurrentIndex</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$iCurrentIndex</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> NextIndex</span><span class="S8">(</span><span class="S9">$iCurrentIndex</span><span class="S8">,</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">),</span><span class="S0"> </span><span class="S9">$reverse</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; FINAL EARLY EXIT check before sending any keys</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$MoveToLocationsStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><span class="S0"> </span><span class="S4">SetError</span><span class="S8">(</span><span class="S3">5</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"Walker turned off mid-step"</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S9">$targetX</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{d down}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">Sleep</span><span class="S8">(</span><span class="S3">30</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{d up}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">&gt;</span><span class="S0"> </span><span class="S9">$targetX</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{a down}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">Sleep</span><span class="S8">(</span><span class="S3">30</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{a up}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S9">$targetY</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{s down}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">Sleep</span><span class="S8">(</span><span class="S3">30</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{s up}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">&gt;</span><span class="S0"> </span><span class="S9">$targetY</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{w down}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">Sleep</span><span class="S8">(</span><span class="S3">30</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{w up}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;MoveToLocationsStep</span><br />
<br />
<span class="S5">Func</span><span class="S0"> NextIndex</span><span class="S8">(</span><span class="S9">$iCurrent</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$iBound</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$reverse</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$reverse</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$iCurrent</span><span class="S0"> </span><span class="S8">-=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$iCurrent</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S9">$iCurrent</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$iBound</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$iCurrent</span><span class="S0"> </span><span class="S8">+=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$iCurrent</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S9">$iBound</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S9">$iCurrent</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$iCurrent</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;NextIndex</span><br />
<br />
<span class="S5">Func</span><span class="S0"> QuickKey</span><span class="S8">(</span><span class="S9">$key</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$window</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hold</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S9">$window</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S4">StringReplace</span><span class="S8">(</span><span class="S9">$key</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"}"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">" down}"</span><span class="S8">))</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">Sleep</span><span class="S8">(</span><span class="S9">$hold</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S9">$window</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S4">StringReplace</span><span class="S8">(</span><span class="S9">$key</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"}"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">" up}"</span><span class="S8">))</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;QuickKey</span><br />
<br />
<br />
<span class="S5">Func</span><span class="S0"> TryBypass</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$lastX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$lastY</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$iCurrentIndex</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$cx</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$cy</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$tx</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S8">[</span><span class="S9">$iCurrentIndex</span><span class="S8">][</span><span class="S3">0</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$ty</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S8">[</span><span class="S9">$iCurrentIndex</span><span class="S8">][</span><span class="S3">1</span><span class="S8">]</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$dx</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$tx</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S9">$cx</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$dy</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$ty</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S9">$cy</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$main</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$side1</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$side2</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">""</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S4">Abs</span><span class="S8">(</span><span class="S9">$dx</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S4">Abs</span><span class="S8">(</span><span class="S9">$dy</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$dx</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$main</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{a}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$side1</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{w}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$side2</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{s}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$main</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{d}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$side1</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{w}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$side2</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{s}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$dy</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$main</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{w}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$side1</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{d}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$side2</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{a}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$main</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{s}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$side1</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{a}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$side2</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{d}</span><span class="S7">"</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$HoldTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">75</span><br />
<br />
<span class="S0">&nbsp; &nbsp; QuickKey</span><span class="S8">(</span><span class="S9">$side1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$HoldTime</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; QuickKey</span><span class="S8">(</span><span class="S9">$side1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$HoldTime</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$nx</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$ny</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$nx</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$cx</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$ny</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$cy</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Bypass via "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$side1</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">" worked. Resuming: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$main</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; QuickKey</span><span class="S8">(</span><span class="S9">$main</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$HoldTime</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nx</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$ny</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; QuickKey</span><span class="S8">(</span><span class="S9">$side2</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$HoldTime</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; QuickKey</span><span class="S8">(</span><span class="S9">$side2</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$HoldTime</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$nx</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$ny</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$nx</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$cx</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$ny</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$cy</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Bypass via "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$side2</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">" worked. Resuming: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$main</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; QuickKey</span><span class="S8">(</span><span class="S9">$main</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$HoldTime</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$nx</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$ny</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Bypass failed: no movement after sidesteps."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;TryBypass</span><br />
<br />
<span class="S5">Func</span><span class="S0"> FindClosestLocationIndex</span><span class="S8">(</span><span class="S9">$currentX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S4">IsArray</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">)</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">)</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"FindClosestLocationIndex =&gt; no valid array."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$minDist</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">999999</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$minIndex</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">For</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aLocations</span><span class="S8">)</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$dx</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">0</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$dy</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S9">$aLocations</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">1</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$dist</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$dx</span><span class="S0"> </span><span class="S8">*</span><span class="S0"> </span><span class="S9">$dx</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S9">$dy</span><span class="S0"> </span><span class="S8">*</span><span class="S0"> </span><span class="S9">$dy</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$dist</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S9">$minDist</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$minDist</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$dist</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$minIndex</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$i</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Next</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$minIndex</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"FindClosestLocationIndex =&gt; No valid locations found."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"FindClosestLocationIndex =&gt; Found index: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$minIndex</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">" Dist="</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$minDist</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S9">$minIndex</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;FindClosestLocationIndex</span><br />
<br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S1">; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CURE FUNCTION</span><br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S5">Func</span><span class="S0"> CureMe</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$Chat</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Checkbox</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Sickness</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sicknessArray</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$HealDelay</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LastHealTime</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$elapsedTimeSinceHeal</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$MovmentSlider</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYLabel</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$Chat</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Check if we have a sickness that is in the array</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S15">_ArraySearch</span><span class="S8">(</span><span class="S9">$sicknessArray</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Sickness</span><span class="S8">)</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S5">Return</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$Healwait</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$MovmentSlider</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">Number</span><span class="S8">(</span><span class="S4">StringRegExpReplace</span><span class="S8">(</span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$PosXLabel</span><span class="S8">),</span><span class="S0"> </span><span class="S7">"[^\d]"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">))</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">Number</span><span class="S8">(</span><span class="S4">StringRegExpReplace</span><span class="S8">(</span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$PosYLabel</span><span class="S8">),</span><span class="S0"> </span><span class="S7">"[^\d]"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">))</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Static</span><span class="S0"> </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentY</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Static</span><span class="S0"> </span><span class="S9">$LastMovementTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$elapsedTimeSinceHeal</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerDiff</span><span class="S8">(</span><span class="S9">$LastHealTime</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Detect movement</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentX</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentY</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LastMovementTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$TimeSinceLastMove</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerDiff</span><span class="S8">(</span><span class="S9">$LastMovementTime</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Old style</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$Checkbox</span><span class="S8">)</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$GUI_CHECKED</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$elapsedTimeSinceHeal</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S9">$HealDelay</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S7">"Project Rogue"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{3}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Cure triggered (old style)"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LastHealTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$elapsedTimeSinceHeal</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S9">$HealDelay</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$TimeSinceLastMove</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S9">$Healwait</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S7">"Project Rogue"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{3}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Cure triggered: Stationary for "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$TimeSinceLastMove</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"ms."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LastHealTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"No cure: Only stationary for "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$TimeSinceLastMove</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"ms."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;CureMe</span><br />
<br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S1">; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;HEALER</span><br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S5">Func</span><span class="S0"> TimeToHeal</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$MovmentSlider</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Checkbox</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$HPAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$MaxHPAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$HealerLabel</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$HealDelay</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LastHealTime</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$elapsedTimeSinceHeal</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$sicknessArray</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Sickness</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$Chat</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ChattOpenAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$healSlider</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$hProcess</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$Healwait</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$MovmentSlider</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$HP</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$HPAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$RealHP</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$HP</span><span class="S0"> </span><span class="S8">/</span><span class="S0"> </span><span class="S3">65536</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$MaxHP</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$MaxHPAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$ChatVal</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ChattOpenAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$HealThreshold</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$healSlider</span><span class="S8">)</span><span class="S0"> </span><span class="S8">/</span><span class="S0"> </span><span class="S3">100</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">Number</span><span class="S8">(</span><span class="S4">StringRegExpReplace</span><span class="S8">(</span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$PosXLabel</span><span class="S8">),</span><span class="S0"> </span><span class="S7">"[^\d]"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">))</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">Number</span><span class="S8">(</span><span class="S4">StringRegExpReplace</span><span class="S8">(</span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$PosYLabel</span><span class="S8">),</span><span class="S0"> </span><span class="S7">"[^\d]"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">))</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Static</span><span class="S0"> </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentY</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Static</span><span class="S0"> </span><span class="S9">$LastMovementTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$elapsedTimeSinceHeal</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerDiff</span><span class="S8">(</span><span class="S9">$LastHealTime</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; --- Detect movement ---</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$currentX</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$currentY</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentX</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$lastY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$currentY</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LastMovementTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$TimeSinceLastMove</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerDiff</span><span class="S8">(</span><span class="S9">$LastMovementTime</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; --- Old style (checkbox) ---</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$Checkbox</span><span class="S8">)</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$GUI_CHECKED</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$ChatVal</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S15">_ArraySearch</span><span class="S8">(</span><span class="S9">$sicknessArray</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Sickness</span><span class="S8">)</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$RealHP</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$MaxHP</span><span class="S0"> </span><span class="S8">*</span><span class="S0"> </span><span class="S9">$HealThreshold</span><span class="S8">)</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$elapsedTimeSinceHeal</span><span class="S0"> </span><span class="S8">&gt;</span><span class="S0"> </span><span class="S9">$HealDelay</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S7">"Project Rogue"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{2}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Heal triggered (old style): HP &lt; threshold"</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LastHealTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; --- Normal logic (requires stationary) ---</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$ChatVal</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S15">_ArraySearch</span><span class="S8">(</span><span class="S9">$sicknessArray</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Sickness</span><span class="S8">)</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S8">-</span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$RealHP</span><span class="S0"> </span><span class="S8">&lt;</span><span class="S0"> </span><span class="S8">(</span><span class="S9">$MaxHP</span><span class="S0"> </span><span class="S8">*</span><span class="S0"> </span><span class="S9">$HealThreshold</span><span class="S8">)</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$elapsedTimeSinceHeal</span><span class="S0"> </span><span class="S8">&gt;</span><span class="S0"> </span><span class="S9">$HealDelay</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$TimeSinceLastMove</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S9">$Healwait</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S7">"Project Rogue"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{2}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Healed: Stationary for "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$TimeSinceLastMove</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"ms | HP &lt; threshold."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LastHealTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Else</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"No heal: Only stationary for "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$TimeSinceLastMove</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">"ms."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;TimeToHeal</span><br />
<br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S1">; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;TARGETING</span><br />
<span class="S1">; ------------------------------------------------------------------------------</span><br />
<span class="S5">Func</span><span class="S0"> AttackModeReader</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$WindowName</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$Type</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$Chat</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$AttackMode</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootingCheckbox</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$TargetStatus</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootQueued</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LootCount</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LootReady</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$LastPlayerX</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LastPlayerY</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$HadTarget</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LastTargetHeld</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$currentTime</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$TargetDelay</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Global</span><span class="S0"> </span><span class="S9">$LootIdleTimer</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$LootIdleWaiting</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$Chat</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$ChattOpenAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$TypeAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$AttackMode</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$AttackModeAddress</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$PlayerX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosXAddress</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$PlayerY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> _ReadMemory</span><span class="S8">(</span><span class="S9">$hProcess</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$PosYAddress</span><span class="S8">)</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; Cancel loot if player moves</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$LastPlayerX</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$LastPlayerY</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$PlayerX</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$LastPlayerX</span><span class="S0"> </span><span class="S5">Or</span><span class="S0"> </span><span class="S9">$PlayerY</span><span class="S0"> </span><span class="S8">&lt;&gt;</span><span class="S0"> </span><span class="S9">$LastPlayerY</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Loot] Player moved manually, cancelling loot queue."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootQueued</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootCount</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootReady</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootIdleWaiting</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$LastPlayerX</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$PlayerX</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$LastPlayerY</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$PlayerY</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; --- Loot kill detection ---</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S4">GUICtrlRead</span><span class="S8">(</span><span class="S9">$LootingCheckbox</span><span class="S8">)</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$GUI_CHECKED</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S1">; Monster targeted</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S5">Not</span><span class="S0"> </span><span class="S9">$HadTarget</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$HadTarget</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LastTargetHeld</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; If new monster targeted, cancel loot idle wait</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$LootIdleWaiting</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Loot] New target acquired. Cancelling idle wait."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootIdleWaiting</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S4">TimerDiff</span><span class="S8">(</span><span class="S9">$LastTargetHeld</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S3">100</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S1">; Held &gt;100ms, stable target</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">ElseIf</span><span class="S0"> </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">65535</span><span class="S0"> </span><span class="S5">Then</span><span class="S0"> </span><span class="S1">; No target (possible kill)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$HadTarget</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S4">TimerDiff</span><span class="S8">(</span><span class="S9">$LastTargetHeld</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S3">100</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootCount</span><span class="S0"> </span><span class="S8">+=</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootQueued</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Loot] Monster kill detected. Loot count now: "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$LootCount</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$HadTarget</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootIdleTimer</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$LootIdleWaiting</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<br />
<span class="S0">&nbsp; &nbsp; </span><span class="S1">; --- Targeter Retarget ---</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$TargetStatus</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">1</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$Type</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">65535</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$Chat</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S4">TimerDiff</span><span class="S8">(</span><span class="S9">$currentTime</span><span class="S8">)</span><span class="S0"> </span><span class="S8">&gt;=</span><span class="S0"> </span><span class="S9">$TargetDelay</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ControlSend</span><span class="S8">(</span><span class="S9">$WindowName</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">""</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"</span><span class="S10">{TAB}</span><span class="S7">"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"[Target] Retargeting with TAB..."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S9">$currentTime</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">TimerInit</span><span class="S8">()</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;AttackModeReader</span><br />
<br />
<br />
<span class="S5">Func</span><span class="S0"> IsBlockedCoord</span><span class="S8">(</span><span class="S9">$x</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$y</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">For</span><span class="S0"> </span><span class="S9">$i</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S3">0</span><span class="S0"> </span><span class="S5">To</span><span class="S0"> </span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aTempBlocked</span><span class="S8">)</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">If</span><span class="S0"> </span><span class="S9">$aTempBlocked</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$x</span><span class="S0"> </span><span class="S5">And</span><span class="S0"> </span><span class="S9">$aTempBlocked</span><span class="S8">[</span><span class="S9">$i</span><span class="S8">][</span><span class="S3">1</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$y</span><span class="S0"> </span><span class="S5">Then</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S5">True</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S5">EndIf</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Next</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Return</span><span class="S0"> </span><span class="S5">False</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;IsBlockedCoord</span><br />
<br />
<span class="S5">Func</span><span class="S0"> MarkCoordAsBlocked</span><span class="S8">(</span><span class="S9">$x</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$y</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">ReDim</span><span class="S0"> </span><span class="S9">$aTempBlocked</span><span class="S8">[</span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aTempBlocked</span><span class="S8">)</span><span class="S0"> </span><span class="S8">+</span><span class="S0"> </span><span class="S3">1</span><span class="S8">][</span><span class="S3">2</span><span class="S8">]</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$aTempBlocked</span><span class="S8">[</span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aTempBlocked</span><span class="S8">)</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><span class="S8">][</span><span class="S3">0</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$x</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S9">$aTempBlocked</span><span class="S8">[</span><span class="S4">UBound</span><span class="S8">(</span><span class="S9">$aTempBlocked</span><span class="S8">)</span><span class="S0"> </span><span class="S8">-</span><span class="S0"> </span><span class="S3">1</span><span class="S8">][</span><span class="S3">1</span><span class="S8">]</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S9">$y</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">ConsoleWrite</span><span class="S8">(</span><span class="S7">"Marked ("</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$x</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">", "</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S9">$y</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S7">") as blocked."</span><span class="S0"> </span><span class="S8">&amp;</span><span class="S0"> </span><span class="S6">@CRLF</span><span class="S8">)</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;MarkCoordAsBlocked</span><br />
<br />
<span class="S5">Func</span><span class="S0"> _WriteMemory</span><span class="S8">(</span><span class="S9">$hProc</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$pAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$value</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S5">Local</span><span class="S0"> </span><span class="S9">$tBuffer</span><span class="S0"> </span><span class="S8">=</span><span class="S0"> </span><span class="S4">DllStructCreate</span><span class="S8">(</span><span class="S7">"dword"</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllStructSetData</span><span class="S8">(</span><span class="S9">$tBuffer</span><span class="S8">,</span><span class="S0"> </span><span class="S3">1</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$value</span><span class="S8">)</span><br />
<span class="S0">&nbsp; &nbsp; </span><span class="S4">DllCall</span><span class="S8">(</span><span class="S7">"kernel32.dll"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"bool"</span><span class="S8">,</span><span class="S0"> </span><span class="S7">"WriteProcessMemory"</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"handle"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$hProc</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S9">$pAddress</span><span class="S8">,</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetPtr</span><span class="S8">(</span><span class="S9">$tBuffer</span><span class="S8">),</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"dword"</span><span class="S8">,</span><span class="S0"> </span><span class="S4">DllStructGetSize</span><span class="S8">(</span><span class="S9">$tBuffer</span><span class="S8">),</span><span class="S0"> </span><span class="S8">_</span><br />
<span class="S0">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="S7">"ptr"</span><span class="S8">,</span><span class="S0"> </span><span class="S3">0</span><span class="S8">)</span><br />
<span class="S5">EndFunc</span><span class="S0"> &nbsp;&nbsp;</span><span class="S1">;==&gt;_WriteMemory</span><br />
<span class="S0"></span></span>
</body>
</html>
